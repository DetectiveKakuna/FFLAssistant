@page "/draft"
@using FFLAssistant.Models.Components
@using FFLAssistant.Client.Components
@using FFLAssistant.Models.Enums
@using Position = FFLAssistant.Models.Enums.Position

<PageTitle>Draft Board</PageTitle>

<MudGrid>
    <MudItem xs="12" Class="px-1">
        <MudContainer Fixed=true Class="pa-2">
            @if (draftPickCards != null && currentDraftState != null)
            {
                <!-- Team Headers -->
                <MudGrid Class="mb-2" Spacing="1">
                    @foreach (var team in currentDraftState.Teams)
                    {
                        <MudItem xs="1">
                            <MudPaper Class="pa-2 text-center"
                                      Style="background-color: #8b4513; color: #f5f5dc; border-radius: 4px; height: 40px; display: flex; align-items: center; justify-content: center; border: 1px solid #4a6348;"
                                      Elevation="0">
                                <MudText Typo="Typo.caption" Style="font-weight: bold; font-size: 11px;">
                                    @team.TeamName
                                </MudText>
                            </MudPaper>
                        </MudItem>
                    }
                </MudGrid>
                <!-- Draft Board -->
                @for (int round = currentDraftState.FirstRelevantRound; round <= currentDraftState.FirstRelevantRound + 2; round++)
                {
                    var roundPicks = GetPicksForRound(round);
                    <MudGrid Class="mb-1" Spacing="1">
                        @foreach (var pick in roundPicks)
                        {
                            <MudItem xs="1">
                                <DraftPickCard PickCard="pick" MyTeamIndex="myTeamIndex ?? 0" TotalTeams="currentDraftState.TotalTeams"/>
                            </MudItem>
                        }
                    </MudGrid>
                }
            }
            else
            {
                <!-- Loading State -->
                <div style="display: flex; justify-content: center; align-items: center; height: 400px;">
                    <MudProgressCircular Color="Color.Primary" Size="Size.Large" Indeterminate="true" />
                    <MudText Typo="Typo.h6" Class="ml-3" Style="color: #f5f5dc;">Loading draft...</MudText>
                </div>
            }
        </MudContainer>
    </MudItem>
    <MudItem xs="12" Class="pr-6">

        @if (draftRankings != null)
        {
            <MudGrid Spacing="2">
                <MudItem xs="4">
                    @* TODO reccomendations *@
                </MudItem>
                <MudItem xs="2">
                    <DraftRankingsList FilteredRankings="@GetRankingsByPosition(Position.QB)"
                                       Title="Quarterbacks"
                                       DefaultDisplay="10" />
                </MudItem>
                <MudItem xs="2">
                    <DraftRankingsList FilteredRankings="@GetRankingsByPosition(Position.RB)"
                                       Title="Running Backs"
                                       DefaultDisplay="10" />
                </MudItem>
                <MudItem xs="2">
                    <DraftRankingsList FilteredRankings="@GetRankingsByPosition(Position.WR)"
                                       Title="Wide Receivers"
                                       DefaultDisplay="10" />
                </MudItem>
                <MudItem xs="2">
                    <DraftRankingsList FilteredRankings="@GetRankingsByPosition(Position.TE)"
                                       Title="Tight Ends"
                                       DefaultDisplay="10" />
                </MudItem>
            </MudGrid>
        }
        else
        {
            <div style="display: flex; justify-content: center; align-items: center; height: 200px;">
                <MudProgressCircular Color="Color.Primary" Size="Size.Medium" Indeterminate="true" />
                <MudText Typo="Typo.body1" Class="ml-3" Style="color: #f5f5dc;">Loading rankings...</MudText>
            </div>
        }
    </MudItem>
</MudGrid>